<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'main.css' %}">
    <title>Kosupure</title>
</head>

<body>
{% csrf_token %}
{% if user.is_authenticated %}
    <header>
        <h1>Welcome to Kosupure, {{ user.username }}! <span><a href="{% url 'logout' %}" class="logout">Logout ?</a></span></h1>
        <h2><a href="{% url 'home' %}">Kosupure Posts</a><h2>
        <hr class="tophr">
    </header>
{% else %}
    <header2>
        <h1>Welcome to Kosupure, visitor!</h1>
        <h2>You are not logged in. <a href="{% url 'login' %}" class="logout">Login</a> <a href="{% url 'users:signup' %}" class="logout">Sign Up</a></h2>
        <h2><a href="{% url 'home' %}">Kosupure Posts</a><h2>
    </header2>
{% endif %}

<div class="container" id="events">

    <div class="col-sm-6">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3>Add an Event</h3>
            </div>
            <div class="panel-body">
                <div class="form-group">
                    <input class="form-control" placeholder="Event Name" v-model="event.name">
                </div>
                <div class="form-group">
                    <textarea class="form-control" placeholder="Event Description" v-model="event.description"></textarea>
                </div>
                <div class="form-group">
                    <input type="date" class="form-control" placeholder="Date" v-model="event.date">
                </div>
                <button class="btn btn-primary" v-on:click="addEvent">Submit</button>
            </div>
        </div>
    </div>

    <div class="col-sm-6">
        <button class="btn btn-primary" @click="order = order * -1">Reverse Order</button>
        <div class="list-group">

            <a href="#" class="list-group-item" v-for="event in events">
                <h4 class="list-group-item-heading">
                    <i class="glyphicon glyphicon-bullhorn"></i> 
                    [[ event.name ]]
                </h4>
                <h5>
                    <i class="glyphicon glyphicon-calendar" v-if="event.date"></i> 
                    [[ event.date ]]
                </h5>
                <p class="list-group-item-text" v-if="event.description">{{ event.description }}</p>
                <button class="btn btn-xs btn-danger" v-on:click="deleteEvent($index)">Delete</button>
            </a>
        </div>
    </div>

</div>
<script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/gsap-latest-beta.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>

    const app = new Vue({
        el: "#events",
        delimiters: ['[[', ']]'],
        data: {
            order: 1,
            event: { name: '', description: '', date: '' },
            events: []
        },
        ready: function() {
            this.fetchEvents();
            },
        
        methods: {
            fetchEvents: function() {
                var events = [
                {
                    id: 1,
                    name: 'Film Premiere',
                    description: 'Go watch that movie.',
                    date: '2016-09-11'
                },
                {
                    id: 2,
                    name: 'Hangover',
                    description: 'It\'s your own fault.',
                    date: '2016-11-01'
                },
                {
                    id: 3,
                    name: 'Add Firebase Support',
                    description: 'Free, hosted database, none of this JS BS.',
                    date: '2016-09-15'
                },
                {
                    id: 4,
                    name: 'Bonfire Night',
                    description: 'Hotdogs and pyrotechnics.',
                    date: '2016-11-04'
                },
                {
                    id: 5,
                    name: 'Halloween',
                    description: 'Get my costume on, get my drink on.',
                    date: '2016-10-31'
                }
                ];
        
                this.$set('events', events);
            },
        
            addEvent: function() {
                if(this.event.name) {
                this.events.push(this.event);
                this.event = { name: '', description: '', date: '' };
                }
            },
            
            deleteEvent: function(index) {
                if (confirm('Are you sure you want to delete this event?')) {
                this.events.splice(index,1);
                }
            }
            }
    })

</script>
</body>